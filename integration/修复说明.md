# å…³é”®Bugä¿®å¤è¯´æ˜

## ğŸ› å‘ç°çš„æ ¹æœ¬é—®é¢˜

**åŸå§‹é—®é¢˜**: è®­ç»ƒå‡†ç¡®ç‡0%

**æ ¹æœ¬åŸå› **: workflow_parserå¯¹AIMEæ•°å­¦ä»»åŠ¡ç”Ÿæˆäº†é”™è¯¯çš„workflowä»£ç 
- ä½¿ç”¨äº†`CustomCodeGenerate` (ä»£ç ç”Ÿæˆå™¨)
- ä½†AIMEæ˜¯æ•°å­¦æ¨ç†ä»»åŠ¡ï¼Œä¸æ˜¯ä»£ç ä»»åŠ¡ï¼
- å¯¼è‡´ç”Ÿæˆçš„éƒ½æ˜¯ä»£ç è€Œä¸æ˜¯æ•°å­¦ç­”æ¡ˆ

## âœ… å·²ä¿®å¤çš„å†…å®¹

### 1. workflow_parser.py - æ ¸å¿ƒä¿®å¤

**ä¿®å¤ç‚¹1**: æ•°æ®é›†ç±»å‹è¯†åˆ«
```python
# æ–°å¢AIMEç­‰æ•°å­¦æ•°æ®é›†çš„è¯†åˆ«
is_math_dataset = dataset_type.upper() in ["AIME", "MATH", "GSM8K"]
```

**ä¿®å¤ç‚¹2**: é»˜è®¤operatoré€‰æ‹©
```python
# ä¿®å¤å‰ï¼šæ‰€æœ‰ä»»åŠ¡é»˜è®¤ç”¨CustomCodeGenerate
operators = ["CustomCodeGenerate"]

# ä¿®å¤åï¼šæ ¹æ®æ•°æ®é›†ç±»å‹é€‰æ‹©
if dataset_type.upper() in ["AIME", "MATH", "GSM8K"]:
    operators = ["Custom", "ScEnsemble"]  # æ•°å­¦ä»»åŠ¡ç”¨Custom
else:
    operators = ["CustomCodeGenerate"]     # ä»£ç ä»»åŠ¡ç”¨ä»£ç ç”Ÿæˆ
```

**ä¿®å¤ç‚¹3**: Workflowé€»è¾‘ç”Ÿæˆ
```python
# ä¿®å¤å‰ï¼šæ•°å­¦ä»»åŠ¡ä¹Ÿç”¨custom_code_generate
sol = await self.custom_code_generate(
    problem=problem,
    entry_point="",  # é”™è¯¯ï¼
    instruction=""
)

# ä¿®å¤åï¼šæ•°å­¦ä»»åŠ¡ç”¨customè®©LLMæ¨ç†
sol = await self.custom(
    problem=problem,
    instruction="Solve this AIME math problem step by step..."
)
```

**ä¿®å¤ç‚¹4**: Ensembleæ•°é‡ä¼˜åŒ–
- ä»£ç ä»»åŠ¡ï¼š3æ¬¡é‡‡æ ·
- æ•°å­¦ä»»åŠ¡ï¼š5æ¬¡é‡‡æ ·ï¼ˆæ•°å­¦éœ€è¦æ›´å¤šå°è¯•ï¼‰

## ğŸ“Š é¢„æœŸæ•ˆæœå¯¹æ¯”

| æŒ‡æ ‡ | ä¿®å¤å‰ | ä¿®å¤åé¢„æœŸ |
|------|--------|-----------|
| ç›´æ¥GPT-4o-mini | N/A | 10-20% |
| Epoch 1-5 | 0% | 5-15% |
| Epoch 6-10 | 0% | 10-20% |
| Epoch 11-20 | 0% | 15-30% |

## ğŸ” å…¶ä»–æ£€æŸ¥

### å·²éªŒè¯çš„é…ç½®
- âœ… AIMEè¯„ä¼°å™¨æ­£ç¡®åŠ è½½15ä¸ªé—®é¢˜
- âœ… ç­”æ¡ˆæå–é€»è¾‘æ­£ç¡®ï¼ˆæå–0-999çš„æ•°å­—ï¼‰
- âœ… å¥–åŠ±è®¡ç®—é€»è¾‘æ­£ç¡®ï¼ˆpass@kï¼‰
- âœ… è¯¾ç¨‹å­¦ä¹ é…ç½®æ­£ç¡®
- âœ… å¥–åŠ±å¡‘å½¢é…ç½®æ­£ç¡®

### å·²ç¡®è®¤å¯ç”¨çš„Operators
- âœ… Custom - é€šç”¨æ¨ç†ï¼ˆAIMEä½¿ç”¨è¿™ä¸ªï¼‰
- âœ… CustomCodeGenerate - ä»£ç ç”Ÿæˆï¼ˆHumanEvalç”¨ï¼‰
- âœ… ScEnsemble - è‡ªä¸€è‡´æ€§é›†æˆ
- âœ… Test - ä»£ç æµ‹è¯•
- âœ… Review - æ£€æŸ¥æ”¹è¿›
- âœ… Revise - ä¿®è®¢æ–¹æ¡ˆ

## ğŸš€ æ˜å¤©è®­ç»ƒå»ºè®®

1. **ä½¿ç”¨ä¿®å¤åçš„ä»£ç **
   ```bash
   cd /root/agentflow/integration
   ./å¯åŠ¨ä¼˜åŒ–è®­ç»ƒ.sh
   ```

2. **è§‚å¯Ÿå‰3ä¸ªepoch**
   - åº”è¯¥èƒ½çœ‹åˆ° avg_score > 0.05ï¼ˆ5%+å‡†ç¡®ç‡ï¼‰
   - å¦‚æœè¿˜æ˜¯0%ï¼Œæ£€æŸ¥æ—¥å¿—ä¸­çš„workflowä»£ç 

3. **æ£€æŸ¥ç”Ÿæˆçš„workflow**
   ```bash
   cat /content/drive/MyDrive/agentflow/outputs/optimized_training/workflows/AIME/round_1_env0/graph.py
   ```
   åº”è¯¥çœ‹åˆ° `await self.custom(...)` è€Œä¸æ˜¯ `custom_code_generate`

## ğŸ“ å·²ä¿®å¤æ–‡ä»¶æ¸…å•

1. âœ… `/root/agentflow/integration/workflow_parser.py` - æ ¸å¿ƒä¿®å¤
2. âœ… `/root/agentflow/integration/ä¼˜åŒ–è¿è¡Œ.yaml` - å·²åŒ…å«è¯¾ç¨‹å­¦ä¹ å’Œå¥–åŠ±å¡‘å½¢
3. âœ… `/root/agentflow/integration/ä¼˜åŒ–è®­ç»ƒ.py` - å·²å®ç°ä¼˜åŒ–è®­ç»ƒé€»è¾‘

## æ€»ç»“

è¿™æ¬¡ä¿®å¤è§£å†³äº†æœ€æ ¹æœ¬çš„é—®é¢˜ï¼š**è®©æ•°å­¦ä»»åŠ¡ä½¿ç”¨æ­£ç¡®çš„æ¨ç†operatorï¼Œè€Œä¸æ˜¯ä»£ç ç”Ÿæˆå™¨**ã€‚

ç†è®ºä¸Šï¼Œä¿®å¤åGPT-4o-miniåº”è¯¥èƒ½è¾¾åˆ°10-20%çš„åŸºå‡†å‡†ç¡®ç‡ï¼ˆè¿™æ˜¯æ­£å¸¸æ°´å¹³ï¼‰ï¼Œç„¶åé€šè¿‡è¯¾ç¨‹å­¦ä¹ å’Œå¥–åŠ±å¡‘å½¢è¿›ä¸€æ­¥æå‡ï¼
