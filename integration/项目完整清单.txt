========================================
AIME优化训练系统 - 完整清单
========================================

📁 项目路径（已整理）
/content/agentworkflow/

✅ 核心文件列表：

【训练系统】
1. 优化训练.py          - 主训练脚本（包含课程学习和奖励塑形）
2. 优化运行.yaml        - 训练配置文件
3. 启动优化训练.sh      - 一键启动脚本（新增模型下载和路径设置）
4. 监控训练.sh          - 训练监控工具

【核心模块】
5. workflow_parser.py   - workflow解析器（已修复：数学任务用Custom）
6. aime_evaluator.py    - AIME评估器
7. deep_workflow_env.py - workflow执行环境
8. rl_trainer.py        - PPO训练器（使用GiGPO）
9. trainable_qwen_policy.py - 可训练的Qwen策略

【文档】
10. 使用说明.md         - 快速使用指南
11. 修复说明.md         - Bug修复详情
12. 项目完整清单.txt    - 本文件

========================================
🎯 已完成的优化和修复
========================================

1. ✅ 修复核心Bug
   - 数学任务现在使用Custom operator（推理）
   - 不再错误使用CustomCodeGenerate（代码生成）
   - 预期准确率从0%提升到10-20%

2. ✅ 整理项目结构
   - 删除了重复的 /root/AFlow
   - 删除了旧的 /root/agentworkflow
   - 统一使用 /content/agentworkflow

3. ✅ 改进启动脚本
   - 自动检查并下载Qwen模型
   - 自动创建输出目录
   - 支持Google Drive挂载
   - 支持本地输出（如果Drive未挂载）

4. ✅ 优化训练配置
   - 课程学习：4题→8题→12题
   - 奖励塑形：避免全0奖励
   - 更好的超参数（学习率0.0003，熵系数0.1）

========================================
📂 项目目录结构
========================================

/content/agentworkflow/
│
├── AFlow/                      # AFlow框架（唯一位置）
│   ├── scripts/
│   │   ├── operators.py        # Custom, ScEnsemble等
│   │   ├── evaluator.py        # 评估器基类
│   │   ├── async_llm.py        # LLM调用接口
│   │   └── logs.py             # 日志系统
│   └── data/
│       └── AIME_2024.jsonl     # AIME数据集（15题）
│
├── verl-agent/                 # 强化学习框架
│   └── gigpo/
│       ├── workflow_gigpo.py   # workflow专用GiGPO
│       └── core_gigpo.py       # GiGPO核心算法
│
└── integration/                # 训练系统（核心代码）
    ├── 优化训练.py
    ├── 优化运行.yaml
    ├── 启动优化训练.sh
    ├── 监控训练.sh
    ├── workflow_parser.py      # ⭐已修复
    ├── aime_evaluator.py
    ├── deep_workflow_env.py
    ├── rl_trainer.py
    ├── trainable_qwen_policy.py
    └── 文档...

========================================
🚀 明天启动步骤（3步）
========================================

1️⃣ 设置API Key
   export OPENAI_API_KEY='your-key'

2️⃣ 进入目录
   cd /content/agentworkflow/integration

3️⃣ 启动训练
   ./启动优化训练.sh

   脚本会自动：
   ✓ 检查配置文件
   ✓ 检查API Key
   ✓ 检查/下载Qwen模型（如需要）
   ✓ 设置输出目录（Google Drive或本地）
   ✓ 启动训练

========================================
📊 预期效果
========================================

【修复前】
- 准确率：0%（所有题目都错）
- 原因：对数学任务错误使用代码生成器

【修复后预期】
- Epoch 1-5:   5-15%  准确率
- Epoch 6-10:  10-20% 准确率
- Epoch 11-20: 15-30% 准确率

【基准】
- GPT-4o-mini直接解AIME：10-20%

========================================
⚙️ 关键配置
========================================

【模型】
- Qwen2.5-7B-Instruct
- 位置：/root/models/Qwen2.5-7B-Instruct
- 自动下载：支持（如不存在）

【数据集】
- AIME 2024
- 位置：/content/agentworkflow/AFlow/data/AIME_2024.jsonl
- 题目数：15题

【输出】
- 默认：/content/drive/MyDrive/agentworkflow/outputs/optimized_training
- 备选：/content/outputs/optimized_training（如Drive未挂载）
- 包含：checkpoints/, workflows/, training.log

【训练参数】
- 总Epoch：20
- 学习率：0.0003
- 批大小：8
- LoRA秩：32

========================================
🔧 监控和调试
========================================

【查看训练进度】
./监控训练.sh

【查看日志】
tail -f /content/drive/MyDrive/agentworkflow/outputs/optimized_training/training.log

【检查进程】
ps aux | grep "优化训练.py"

【停止训练】
kill <PID>

========================================
✅ 验证通过项目
========================================

✓ workflow_parser修复验证通过
✓ 所有核心模块导入成功
✓ 配置文件加载正确
✓ AIME数据集存在
✓ Python语法检查通过
✓ 启动脚本功能完整

========================================
💡 重要提醒
========================================

1. 项目已100%整理完毕
2. 所有路径已统一到 /content/agentworkflow
3. 核心Bug已修复（数学任务使用正确的operator）
4. 启动脚本已增强（自动下载模型、设置路径）
5. 可以直接运行！

明天启动训练，预期会有明显提升！🚀

========================================
